Dim startTime As DateTime = DateTime.Now
Dim maxWaitTime As TimeSpan = TimeSpan.FromMinutes(5)

While DateTime.Now - startTime < maxWaitTime
    Try
        Dim outlookApp As Object = CreateObject("Outlook.Application")
        Dim session As Object = outlookApp.Session
        Dim syncObjects As Object = session.SyncObjects
        Dim anySyncRunning As Boolean = False
        
        For i As Integer = 1 To syncObjects.Count
            Dim syncObj As Object = syncObjects.Item(i)
            If CBool(syncObj.IsRunning) Then
                anySyncRunning = True
                Exit For
            End If
        Next
        
        If Not anySyncRunning Then
            output = "true"
            Exit While
        End If
        
        System.Threading.Thread.Sleep(3000)
        
    Catch ex As Exception
        output = "true"
        Exit While
    End Try
End While

If output <> "true" Then
    output = "false"
End If
